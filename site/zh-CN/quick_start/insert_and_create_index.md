---
id: insert_and_create_index.md
---

# 插入向量并创建索引

创建并启动 Milvus 容器后，我们就可以使用 RESTful 接口轻松体验 Milvus 的各种功能。

我们将在终端中使用 `curl` 命令发送 HTTP 请求，命令格式如下：

```shell
$ curl -X <VERB> '<PROTOCOL>://<HOST>:<PORT>/<PATH>[?<QUERY_STRING>]' [-d '<BODY>']
```

每个部分含义如下：
  - `<VERB>`: HTTP 请求方法。
  - `<PROTOCOL>`: 协议名称。目前 Milvus 只支持 HTTP。
  - `<HOST>`: 服务域名或 IP 地址。若 Milvus 实例运行在本地主机上，指定其值为 `localhost` 或 `127.0.0.1`。
  - `<PORT>`: 端口。此处我们指定为 19121。
  - `<PATH>`: 请求路径。
  - `<QUERY_STRING>`: 查询请求参数。
  - `<BODY>`: 请求体。存放请求的具体内容。比如发送一个创建集合的请求，请求体中存放集合的各种参数。请求体内容是JSON格式。

<div class="alert note">
<code>[]</code> 表示可选参数。
</div>


## 创建集合

创建集合的请求路径为 `collections`。

```shell
$ curl -X POST 'http://localhost:19121/collections' -d '{"collection_name": "test", "dimension": 8}'
```

参数 `collection_name` 指定集合的名称，`dimension` 指定存储在集合中的向量的维度。

此处我们创建名为 `test` 的集合，并指定存储的向量维度为 8。Milvus 执行成功后，返回：

```shell
{
  "message":"OK",
  "code":0
}
```

## 插入向量

创建好集合后，我们就可以往其中插入向量了。插入向量的请求路径为 `collections/<collection_name>/vectors`，其中 `<collection_name>` 为目标集合。在下方示例代码中，我们指定目标集合为 `test`。

```shell
$ curl -X POST 'http://localhost:19121/collections/test/vectors' -d \
'{ 
    "vectors": [  
      [0.78, 0.23, 0.44, 0.59, 0.79, 0.56, 0.45, 0.34],
      [0.31, 0.62, 0.74, 0.19, 0.33, 0.01, 0.67, 0.34],
      [0.41, 0.67, 0.29, 0.42, 0.72, 0.57, 0.12, 0.34],
      [0.15, 0.89, 0.66, 0.96, 0.69, 0.53, 0.74, 0.41],
      [0.99, 0.38, 0.91, 0.67, 0.67, 0.58, 0.58, 0.08],
      [0.74, 0.92, 0.07, 0.48, 0.39, 0.36, 0.38, 0.14],
      [0.36, 0.19, 0.42, 0.49, 0.56, 0.34, 0.57, 0.09],
      [0.58, 0.63, 0.11, 0.39, 0.95, 0.12, 0.45, 0.54],
      [0.21, 0.81, 0.23, 0.29, 0.31, 0.58, 0.15, 0.39],
      [0.42, 0.20, 0.59, 0.19, 0.74, 0.76, 0.47, 0.34]
    ]   
}'
```

参数 `vectors` 指定插入的向量。请确保插入的向量与创建集合时指定的向量维度一致。

上条命令向集合 `test` 中插入了 10 条向量。执行成功后，Milvus 会返回插入向量的 ID：

```shell
{
  "ids":[
    "1591324710861000000",
    "1591324710861000001",
    "1591324710861000002",
    "1591324710861000003",
    "1591324710861000004",
    "1591324710861000005",
    "1591324710861000006",
    "1591324710861000007",
    "1591324710861000008",
    "1591324710861000009"
  ]
}
```

此处返回的向量 ID 是由 Milvus 根据系统时间戳自动生成，因此每次运行结果会有不同。

## 创建索引

为集合创建索引可以加快搜索速度。Milvus 支持多种类型的向量索引，详情请参考 [支持的索引](index.md)。

创建索引的请求路径为 `collections/<collection_name>/indexes`，其中 `<collection_name>` 为目标集合。在下方示例代码中，我们指定目标集合为 `test`。

```shell
$ curl -X POST 'http://127.0.0.1:19121/collections/test/indexes' -d '{"index_type": "IVFFLAT", "params":{"nlist": 2}}'
```

参数 `index_type` 指定索引类型，`params` 指定索引的参数。

此处我们设置索引为 `IVFFLAT`，索引参数 `nlist` 值为 2。成功创建索引后，返回：

```shell
{
  "message": "OK",
  "code": 0
}
```
